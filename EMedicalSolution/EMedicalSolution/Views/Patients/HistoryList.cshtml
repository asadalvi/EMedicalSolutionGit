

<div class="w3-container tablecontainer-history dashboardDiv" id="patients-tab">

<div class="w3-row w3-padding-16">
    <input type="hidden" id="historyList_patientID" name="patientID" value="@ViewBag.patientID" />
    
    <div class="w3-row w3-padding-16">
        <button type="button" class="w3-btn w3-green" id="loadInsuranceTypeForm">+ Add New </button>    
    </div>
    <input type="hidden"   id="ViewBag_PatienName" />
    <div class="w3-responsive">

        <div id="partialPatientInsuranceType">
        </div>
        
        <table class="w3-table-all w3-hoverable" id="patientHistoryDataTable">
            <thead>
                <tr>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Insurance Type</th>
                    <th>Insurance Card</th>
                    <th>Created</th>
                    <th>Action</th>
                    <th>Info</th>
                </tr>

            </thead>
            <tbody id="patient_history_views"></tbody>
        </table>

        
    </div>
</div>
</div>



<script src="~/Scripts/jquery.validate.min.js"></script>
<script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>
<script src="~/Scripts/jquery.dataTables.min.js"></script>
<script src="~/Scripts/jquery-ui-1.12.1.min.js"></script>
<script src="~/Scripts/date.format.js"></script>

<script>
  
        var patientId = $("#historyList_patientID").val();
        var pName = $("#ViewBag_PatienName").val();
        if (pName !== undefined && pName !== "") {
            $("#PatienName").html("");
            $("#PatienName").html("Pateint Name: "+ pName);
            $("#PatienName").css("display", "block");
            $("#ViewBag_PatienName").val('');
            pName = "";
         }
        var oTable = $("#patientHistoryDataTable").DataTable({

            "ajax": {
                "url": '/Patients/getHistoryList/' + patientId,
                "type": 'post',
                "datatype": "json"
            },
            "columns": [
                { "data": "FirstName", "autoWidth": true },
                { "data": "LastName", "autoWidth": true },
                 { "data": "Title", "autoWidth": true },
                  {
                      "data": "filename", "render": function (data) {
                             if (data !== undefined) {
                              var filename = data.split('\\').pop();
                              return '<span class="fa fa-download"><a href="/Patients/DownloadInsuranceCard/?fileName=' + filename + '">  Download<a></span>';
                          }
                      }
                  },
                {
                    "data": "Created", "autoWidth": true, "render": function (data) {
                        var date = new Date(parseInt(data.substr(6)));
                        var sdate = date.format("mmm d, yyyy");
                        return sdate;
                    }
                },

                {
                    "data": "ID", "render": function (data) {
                        return '<a class="popup  w3-btn w3-blue" href="/Patients/Wizard/' + data + '">Edit<a>';
                    }
                },
                 {
                     "data": "ID", "render": function (data) {
                         return '<a class="popup  w3-btn w3-blue" href="/Patients/patientInfo/' + data + '">View<a>';
                     }
                 }
            ]
        });

        
        $('#loadInsuranceTypeForm').click(function () {
            $('#partialPatientInsuranceType').load('@Url.Action("PatientInsuranceType", "Patients", new { id = ViewBag.patientID })');
        });

</script>



